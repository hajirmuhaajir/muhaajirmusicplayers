<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Security Headers (CSP longgar untuk audio) -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src * blob: data:; img-src * data:; connect-src *;">

  <!-- Favicon & Manifest (PWA) -->
  <link rel="icon" type="image/png" href="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png">
  <link rel="manifest" href="data:application/manifest+json,{
    \"name\": \"Muhaajir Music Player\",
    \"short_name\": \"Muhaajir\",
    \"start_url\": \".\",
    \"display\": \"standalone\",
    \"background_color\": \"#0a0a0a\",
    \"theme_color\": \"#ffd700\",
    \"icons\": [{
      \"src\": \"https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png\",
      \"sizes\": \"512x512\",
      \"type\": \"image/png\"
    }]
  }">

  <title>Muhaajir Music</title>
  <style>
    /* ----- RESET & VARIABEL PREMIUM (DEFAULT DARK) ----- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-deep: #0a0a0a;
      --panel-charcoal: #141414;
      --gold-primary: #ffd700; /* akan diubah dinamis */
      --text-bright: #f8fafc;
      --text-subtle: #94a3b8;
      --border-dim: #1e293b;
      --glass-bg: rgba(20, 20, 20, 0.8);
      --shadow-heavy: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      --shadow-glow: 0 0 15px rgba(255, 215, 0, 0.2);
      --transition-smooth: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      --dropdown-bg: #1e1e1e;
      --hover-bg: #222;
      --active-bg: #1e1e1e;
      --scrollbar-thumb: var(--gold-primary);
      --scrollbar-track: #1e1e1e;
      --font-primary: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Plus Jakarta Sans', sans-serif;
    }

    /* Light mode */
    :root[data-theme="light"] {
      --bg-deep: #f5f5f5;
      --panel-charcoal: #ffffff;
      --gold-primary: #b8860b;
      --text-bright: #1a1a1a;
      --text-subtle: #4a5568;
      --border-dim: #e2e8f0;
      --glass-bg: rgba(255, 255, 255, 0.9);
      --shadow-heavy: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      --shadow-glow: 0 0 15px rgba(184, 134, 11, 0.2);
      --dropdown-bg: #ffffff;
      --hover-bg: #f0f0f0;
      --active-bg: #fafafa;
      --scrollbar-thumb: #b8860b;
      --scrollbar-track: #e0e0e0;
    }

    /* Proteksi seleksi & anti-copy diperkuat */
    body, .lyrics-display, .track-item, .song-title-large, 
    .playback-status, .footer-essentials, .btn-core, 
    .volume-integrated, .progress-container, .time-labels {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    /* Khusus lirik: benar-benar tidak bisa disorot */
    .lyrics-display, .lyrics-display * {
      user-select: none !important;
      -webkit-user-select: none !important;
    }

    body {
      background: var(--bg-deep);
      color: var(--text-bright);
      font-family: var(--font-primary);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 16px;
      margin: 0;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    /* LOGIN SCREEN */
    .login-screen {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: var(--bg-deep);
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.6s;
      opacity: 1;
      visibility: visible;
    }
    .login-screen.hidden {
      opacity: 0;
      visibility: hidden;
    }
    .login-logo {
      width: 120px;
      margin-bottom: 32px;
      filter: brightness(0) invert(1) drop-shadow(0 0 20px rgba(255,215,0,0.5));
      animation: softPulse 2s infinite ease-in-out;
    }
    :root[data-theme="light"] .login-logo {
      filter: brightness(0) invert(0) drop-shadow(0 0 20px rgba(184,134,11,0.3));
    }
    .login-spinner {
      width: 48px; height: 48px;
      border: 4px solid rgba(255,215,0,0.2);
      border-top-color: var(--gold-primary);
      border-radius: 50%;
      animation: spin 1s infinite linear;
      box-shadow: 0 0 20px rgba(255,215,0,0.3);
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes softPulse {
      0% { opacity: 0.8; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.05); }
      100% { opacity: 0.8; transform: scale(1); }
    }

    /* HEADER */
    #mainHeader {
      width: min(1200px, 96vw);
      margin-bottom: 16px;
      z-index: 100;
    }
    .header-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 0;
    }
    .logo-link {
      display: inline-block;
      transition: var(--transition-smooth);
    }
    .logo-link:hover {
      transform: scale(1.05);
      filter: drop-shadow(0 0 10px var(--gold-primary));
    }
    .header-logo {
      height: 48px; width: auto;
      filter: brightness(0) invert(1);
    }
    :root[data-theme="light"] .header-logo {
      filter: brightness(0) invert(0);
    }
    .header-clock {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--gold-primary);
      background: rgba(255,215,0,0.1);
      padding: 8px 16px;
      border-radius: 40px;
      border: 1px solid rgba(255,215,0,0.3);
      backdrop-filter: blur(4px);
      letter-spacing: 2px;
      box-shadow: var(--shadow-glow);
    }
    .header-controls {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    .theme-toggle {
      background: rgba(255,215,0,0.1);
      border: 1px solid rgba(255,215,0,0.3);
      border-radius: 40px;
      padding: 8px 16px;
      cursor: pointer;
      color: var(--gold-primary);
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition-smooth);
      backdrop-filter: blur(4px);
    }
    .theme-toggle:hover {
      background: rgba(255,215,0,0.2);
      transform: scale(1.05);
    }
    .theme-toggle span { font-size: 0.9rem; font-weight: 500; }

    /* Master container (Glassmorphism) */
    .master-container {
      width: min(1200px, 96vw);
      background: var(--glass-bg);
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
      border: 1px solid rgba(255,215,0,0.15);
      border-radius: 32px;
      overflow: hidden;
      display: flex;
      flex-direction: row;
      box-shadow: var(--shadow-heavy);
      margin-bottom: 20px;
      transition: var(--transition-smooth);
    }

    .resonance-chamber {
      flex: 1.3;
      padding: 40px 36px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: linear-gradient(145deg, rgba(20,20,20,0.4) 0%, rgba(0,0,0,0.6) 100%);
      border-right: 1px solid rgba(255,215,0,0.1);
    }

    .tape-rack {
      flex: 0.9;
      background: rgba(10,10,10,0.6);
      backdrop-filter: blur(20px);
      display: flex;
      flex-direction: column;
      border-left: 1px solid rgba(255,215,0,0.1);
    }

    .brand-logo {
      display: flex; align-items: center; gap: 10px; margin-bottom: 24px;
    }
    .brand-logo img {
      height: 36px; filter: brightness(0) invert(1);
    }
    :root[data-theme="light"] .brand-logo img { filter: brightness(0) invert(0); }
    .brand-logo span {
      font-size: 0.75rem; letter-spacing: 2px; color: var(--text-subtle);
      border-left: 1px solid var(--border-dim); padding-left: 12px;
    }

    .album-breadcrumb {
      font-size: 0.75rem; letter-spacing: 3px; color: var(--gold-primary);
      text-transform: uppercase; font-weight: 700; margin-bottom: 12px;
    }

    .song-title-large {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 800; line-height: 1.1; letter-spacing: -0.02em;
      margin: 8px 0 12px; color: var(--text-bright);
      word-break: break-word; text-shadow: 0 2px 5px rgba(0,0,0,0.5);
    }

    .meta-row {
      display: flex; gap: 20px; align-items: center; flex-wrap: wrap;
      font-size: 0.75rem; color: var(--text-subtle); margin-bottom: 24px;
    }
    .meta-row span:last-child {
      color: var(--gold-primary); background: rgba(255,215,0,0.08);
      padding: 4px 10px; border-radius: 30px;
    }

    .playback-status {
      font-size: 0.85rem; font-weight: 500; color: var(--gold-primary);
      background: rgba(255,215,0,0.05); display: inline-block; padding: 6px 14px;
      border-radius: 40px; margin-bottom: 20px; border: 1px solid rgba(255,215,0,0.2);
      backdrop-filter: blur(4px); width: fit-content;
    }

    /* Lyrics container tanpa mask fade, semua lirik terang */
    .lyrics-display {
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(4px);
      border-left: 3px solid var(--gold-primary);
      padding: 15px 20px; /* Padding lebih rapat */
      border-radius: 0 16px 16px 0;
      font-size: 0.95rem;
      line-height: 1.4; /* Line height lebih kecil */
      color: var(--text-bright);
      min-height: 180px;
      max-height: 260px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-word;
      scrollbar-width: thin;
      scrollbar-color: var(--gold-primary) transparent;
      margin: 16px 0 24px;
      box-shadow: inset 0 0 20px rgba(0,0,0,0.6);
      transition: opacity 0.3s ease;
      /* Hapus efek fade */
      -webkit-mask-image: none;
      mask-image: none;
      scroll-behavior: smooth;
      text-align: left; /* Rata kiri */
    }
    .lyrics-display::-webkit-scrollbar { width: 5px; }
    .lyrics-display::-webkit-scrollbar-thumb { background: var(--gold-primary); border-radius: 10px; }

    /* Styling untuk baris lirik statis: semua terang, jarak rapat */
    .lyric-line {
      display: block;
      opacity: 1 !important;
      color: var(--text-bright) !important;
      line-height: 1.4;
      margin-bottom: 4px; /* Margin kecil antar baris */
      font-size: 0.95rem;
      pointer-events: auto;
      transition: none; /* tidak perlu efek */
    }

    /* Jarak antar paragraf (untuk baris kosong) */
    .lyric-paragraph-space {
      height: 10px;
      display: block;
    }

    /* Progress bar */
    .progress-container {
      width: 100%; height: 6px; background: var(--border-dim);
      border-radius: 10px; cursor: pointer; margin: 20px 0 8px;
      transition: var(--transition-smooth);
    }
    .progress-container:hover { height: 8px; background: var(--text-subtle); }
    #progress-fill {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--gold-primary), color-mix(in srgb, var(--gold-primary) 80%, white));
      border-radius: 10px; box-shadow: 0 0 10px var(--gold-primary);
    }
    .time-labels {
      display: flex; justify-content: space-between;
      font-size: 0.7rem; font-family: 'JetBrains Mono', monospace; color: var(--text-subtle);
      margin-bottom: 18px;
    }

    /* VISUALIZER DIHAPUS */

    .controls-wrapper {
      background: rgba(255,255,255,0.02); border: 1px solid rgba(255,215,0,0.15);
      border-radius: 28px; padding: 22px 26px; margin-top: 10px;
      backdrop-filter: blur(8px);
    }
    .controls-main {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;
    }
    .btn-core {
      background: transparent; border: none; color: var(--text-subtle);
      font-size: 1.4rem; cursor: pointer; transition: var(--transition-smooth);
      width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
      border-radius: 50%;
    }
    .btn-core:hover { color: var(--text-bright); background: rgba(255,255,255,0.05); transform: scale(1.1); }
    .btn-core.active { color: var(--gold-primary); text-shadow: 0 0 8px var(--gold-primary); }

    .play-pause-circle {
      width: 64px; height: 64px; background: var(--text-bright); border-radius: 50%;
      display: flex; align-items: center; justify-content: center; cursor: pointer;
      transition: var(--transition-smooth); box-shadow: 0 8px 20px rgba(0,0,0,0.6);
    }
    :root[data-theme="light"] .play-pause-circle { background: var(--gold-primary); }
    .play-pause-circle:hover {
      background: var(--gold-primary); transform: scale(1.07);
      box-shadow: 0 0 30px var(--gold-primary);
    }
    .play-pause-circle svg { width: 28px; height: 28px; fill: var(--bg-deep); }

    .volume-integrated {
      display: flex; align-items: center; gap: 18px; padding-top: 12px;
      border-top: 1px solid rgba(255,215,0,0.15);
    }
    .volume-integrated span {
      font-size: 0.7rem; font-weight: 600; letter-spacing: 1.5px;
      color: var(--gold-primary); min-width: 38px;
    }
    .volume-integrated input[type=range] {
      flex: 1; height: 4px; -webkit-appearance: none; background: var(--border-dim); border-radius: 10px;
    }
    .volume-integrated input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none; width: 14px; height: 14px; background: var(--gold-primary);
      border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px gold;
    }

    .rack-header {
      padding: 20px 24px; border-bottom: 1px solid rgba(255,215,0,0.15);
      display: flex; align-items: center; justify-content: space-between;
      font-size: 0.8rem; font-weight: 700; letter-spacing: 1.5px; color: var(--text-subtle);
    }
    .header-logo img { height: 28px; filter: brightness(0) invert(0.7); }
    :root[data-theme="light"] .header-logo img { filter: brightness(0) invert(0.3); }

    .playlist-scroll {
      flex: 1; overflow-y: auto; padding: 12px 8px;
      scrollbar-width: thin; scrollbar-color: var(--gold-primary) transparent;
    }
    .playlist-scroll::-webkit-scrollbar { width: 5px; }
    .playlist-scroll::-webkit-scrollbar-thumb { background: var(--gold-primary); border-radius: 10px; }

    .group-label {
      font-size: 0.7rem; font-weight: 800; color: var(--gold-primary);
      padding: 20px 16px 6px; text-transform: uppercase; letter-spacing: 1px;
    }
    .track-item {
      display: flex; align-items: center; padding: 12px 16px; border-radius: 12px;
      cursor: pointer; transition: var(--transition-smooth); margin: 2px 0;
    }
    .track-item:hover { background: var(--hover-bg); transform: translateX(4px); }
    .track-item.active {
      background: var(--active-bg); border-left: 4px solid var(--gold-primary);
      box-shadow: var(--shadow-glow);
    }
    .t-num { font-size: 0.7rem; color: var(--text-subtle); width: 32px; font-family: monospace; }
    .t-name {
      font-size: 0.9rem; font-weight: 500; flex: 1;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--text-bright);
    }
    .track-item.active .t-name { color: var(--gold-primary); font-weight: 600; }

    /* Footer - tanpa link */
    .footer-essentials {
      width: min(1200px, 96vw); display: flex; justify-content: center;
      align-items: center; padding: 16px 8px 8px; border-top: 1px solid var(--border-dim);
      color: var(--text-subtle); font-size: 0.75rem; margin-top: 4px;
      background: transparent; z-index: 5;
    }
    .footer-logo { display: flex; align-items: center; gap: 6px; }
    .footer-logo img { height: 18px; filter: brightness(0) invert(0.8); }
    :root[data-theme="light"] .footer-logo img { filter: brightness(0) invert(0.4); }
    .heart { display: inline-block; color: #ff4d4d; animation: beat 1.2s infinite; }
    @keyframes beat { 0%,100%{ transform:scale(1); } 50%{ transform:scale(1.3); } }

    .logo-watermark {
      position: fixed; bottom: 12px; right: 16px; opacity: 0.1; pointer-events: none; z-index: 999;
    }
    .logo-watermark img { height: 40px; filter: brightness(0) invert(1); }
    :root[data-theme="light"] .logo-watermark img { filter: brightness(0) invert(0); }

    #rotating-name {
      transition: opacity 0.25s; font-weight: 700; color: var(--gold-primary);
      min-width: 60px; display: inline-block;
    }

    @media (max-width: 700px) {
      .master-container { flex-direction: column; border-radius: 24px; }
      .resonance-chamber { border-right: none; border-bottom: 1px solid var(--border-dim); padding: 28px 20px; }
      .tape-rack { height: 360px; }
      .song-title-large { font-size: 2rem; }
      .controls-wrapper { padding: 18px 16px; }
      .play-pause-circle { width: 56px; height: 56px; }
      .volume-integrated { gap: 8px; }
      .footer-essentials { flex-direction: column; align-items: center; }
      .header-logo { height: 40px; }
      .header-clock { font-size: 1rem; padding: 6px 12px; }
      .theme-toggle span { display: none; }
    }
  </style>
</head>
<body>
  <!-- LOGIN SCREEN -->
  <div class="login-screen" id="loginScreen">
    <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="Muhaajir Logo" class="login-logo" loading="lazy" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22120%22%20height%3D%22120%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2245%22%20fill%3D%22%23ffd700%22%20%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2270%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23000%22%3E¬µ%3C%2Ftext%3E%3C%2Fsvg%3E';">
    <div class="login-spinner"></div>
  </div>

  <!-- HEADER -->
  <header id="mainHeader">
    <div class="header-container">
      <a href="#home" class="logo-link">
        <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="Muhaajir" class="header-logo" loading="lazy" onerror="this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2248%22%20height%3D%2248%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2245%22%20fill%3D%22%23ffd700%22%20%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2270%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23000%22%3E¬µ%3C%2Ftext%3E%3C%2Fsvg%3E';">
      </a>
      <div class="header-controls">
        <div class="theme-toggle" id="themeToggle">
          <span id="themeIcon">üåô</span>
          <span id="themeText">Gelap</span>
        </div>
        <div class="header-clock" id="clock">--:--</div>
      </div>
    </div>
  </header>

  <!-- PLAYER UTAMA -->
  <div class="master-container">
    <div class="resonance-chamber">
      <div>
        <div class="brand-logo">
          <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="muhaajir" loading="lazy" onerror="this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2236%22%20height%3D%2236%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2245%22%20fill%3D%22%23ffd700%22%20%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2270%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23000%22%3E¬µ%3C%2Ftext%3E%3C%2Fsvg%3E';">
          <span>STUDIO RESONANSI</span>
        </div>
        <div class="album-breadcrumb" id="display-album">Arsip Suara</div>
        <h1 class="song-title-large" id="display-title">Memuat...</h1>
        <div class="meta-row">
          <span>‚è£ MUHAAJIR</span>
          <span>‚è§ 2025</span>
          <span>[NO COPYRIGHT]</span>
        </div>
        <div class="playback-status" id="playback-status">‚è∏Ô∏è Menjeda</div>
        <div class="lyrics-display" id="lyrics-display">üéß Pilih kaset dari rak untuk memutar suara.</div>
      </div>

      <div>
        <div class="progress-container" id="prog-root">
          <div id="progress-fill"></div>
        </div>
        <div class="time-labels">
          <span id="time-now">0:00</span>
          <span id="time-end">0:00</span>
        </div>

        <div class="controls-wrapper">
          <div class="controls-main">
            <button class="btn-core" id="shuffle-btn" title="Acak">‚Üª</button>
            <button class="btn-core" id="prev-btn" style="font-size: 1.8rem;">‚óÅ</button>
            <div class="play-pause-circle" id="play-trigger">
              <svg id="play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <button class="btn-core" id="next-btn" style="font-size: 1.8rem;">‚ñ∑</button>
            <button class="btn-core" id="repeat-btn" title="Ulang">‚Üª</button>
            <!-- Ikon share minimalis -->
            <button class="btn-core" id="share-icon-btn" title="Bagikan ke WhatsApp">üì§</button>
          </div>
          <div class="volume-integrated">
            <span>VOL</span>
            <input type="range" id="vol-slider" min="0" max="1" step="0.05" value="0.7">
          </div>
        </div>
      </div>
    </div>

    <!-- DAFTAR PUTAR -->
    <div class="tape-rack">
      <div class="rack-header">
        <span>DAFTAR PUTAR ‚Ä¢ ORIGINAL</span>
        <div class="header-logo">
          <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="¬µ" loading="lazy" onerror="this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2228%22%20height%3D%2228%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2245%22%20fill%3D%22%23ffd700%22%20%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2270%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23000%22%3E¬µ%3C%2Ftext%3E%3C%2Fsvg%3E';">
        </div>
      </div>
      <div class="playlist-scroll" id="playlist-inject"></div>
    </div>
  </div>

  <!-- FOOTER (tanpa link) -->
  <div class="footer-essentials">
    <span class="footer-logo">
      <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="¬µ" loading="lazy" onerror="this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%20100%20100%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2245%22%20fill%3D%22%23ffd700%22%20%2F%3E%3Ctext%20x%3D%2250%22%20y%3D%2270%22%20font-size%3D%2250%22%20text-anchor%3D%22middle%22%20fill%3D%22%23000%22%3E¬µ%3C%2Ftext%3E%3C%2Fsvg%3E';">
      ¬© 2025-2026 Muhaajir ¬∑ <span class="heart">‚ù§Ô∏è</span> 
      <span style="margin-left: 6px;">Terima kasih <span id="rotating-name">Regina‚ù§Ô∏è</span></span>
    </span>
  </div>

  <!-- AUDIO ELEMENT -->
  <audio id="audio-engine" preload="metadata"></audio>
  <div class="logo-watermark">
    <img src="https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png" alt="¬µ watermark" loading="lazy" onerror="this.style.display='none';">
  </div>

  <script>
    (function() {
      'use strict';

      // ================== PROTEKSI SUPER ==================
      document.addEventListener('contextmenu', e => e.preventDefault());
      document.addEventListener('keydown', e => {
        const key = e.key.toLowerCase();
        if (e.key === 'F12' || 
            (e.ctrlKey && e.shiftKey && (key === 'i' || key === 'j' || key === 'c' || key === 'u')) ||
            (e.ctrlKey && (key === 'u' || key === 'c' || key === 'v' || key === 'x' || key === 's'))) {
          e.preventDefault();
          return false;
        }
      });

      // Jam digital
      function updateClock() {
        const clock = document.getElementById('clock');
        if (!clock) return;
        const now = new Date();
        clock.textContent = now.getHours().toString().padStart(2,'0') + ':' + now.getMinutes().toString().padStart(2,'0');
      }
      updateClock();
      setInterval(updateClock, 1000);

      // Theme toggle
      const themeToggle = document.getElementById('themeToggle');
      const themeIcon = document.getElementById('themeIcon');
      const themeText = document.getElementById('themeText');
      const root = document.documentElement;
      const savedTheme = localStorage.getItem('muhaajir_theme') || 'dark';
      root.setAttribute('data-theme', savedTheme);
      updateThemeButton(savedTheme);

      function updateThemeButton(theme) {
        themeIcon.textContent = theme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
        themeText.textContent = theme === 'dark' ? 'Gelap' : 'Terang';
      }
      themeToggle.addEventListener('click', () => {
        const current = root.getAttribute('data-theme') || 'dark';
        const newTheme = current === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', newTheme);
        localStorage.setItem('muhaajir_theme', newTheme);
        updateThemeButton(newTheme);
      });

      // ================== SHARE WHATSAPP DINAMIS ==================
      function shareToWhatsApp(songName) {
        // Mengambil URL halaman saat ini secara otomatis (link GitHub Pages)
        const currentUrl = window.location.href;
        const text = `*${songName}* - Muhaajir | ${currentUrl}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
      }

      // Data lagu
      const rawSongs = [
        { name: "Lintasan Tak Bermakna", group: "Fragmen Suara", url: "https://www.dropbox.com/scl/fi/42d6gtx7f7tocie3whf2h/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Lintasan-20Tak-20Bermakna.mp3?rlkey=9bim2pumtfjcwmrhq9127fnpd&st=6e9nrwwe&raw=1", gdId: "1_Dn7CsNUNkECXotJYZcofSV90--d0mbg" },
        { name: "Padahal Sudah Bilang", group: "Fragmen Suara", url: "https://www.dropbox.com/scl/fi/30o3te9g5k0mparg46ugd/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Padahal-20Sudah-20Bilang.mp3?rlkey=iz0oliiy3ddlzh4m84jw1oacb&st=coy2ftp3&raw=1", gdId: "1xDIhBggeN2hbveqyMWE5Q6wCOqxllboP" },
        { name: "Mimpi yang Tertunda", group: "Fragmen Suara", url: "https://www.dropbox.com/scl/fi/ii4rxckfguu3hg2d7czdz/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Mimpi-20yang-20Tertunda.mp3?rlkey=5iyrx794rg46bj1zyo3gret6e&st=n45d3ba1&raw=1", gdId: "1Iu5Ecf105P-KsxUrqIhNajmhIvKXzJfk" },
        { name: "Langit Masih Sama", group: "Fragmen Suara", url: "https://www.dropbox.com/scl/fi/bmrmy3eglkxxqcqp0klou/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Langit-20Masih-20Sama.mp3?rlkey=j3o7h2letkcf4vkekkj0uga7z&st=kevxjqpn&raw=1", gdId: "1zBxxORALIkAdsWDK6L-rvrUIxYkpHNGT" },
        { name: "Suatu Hari Nanti", group: "Fragmen Suara", url: "https://www.dropbox.com/scl/fi/kph6ukril5n4ybsvavncd/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Suatu-20Hari-20Nanti.mp3?rlkey=76ltwumwy64f87swdqmof2y9j&st=vuu0iqhs&raw=1", gdId: "1XGef_7uBzQyiXnRr34CbBaWOt3-GssOd" },
        { name: "Nada Terpendam", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/jvnjos6dltx1rqcnkhbp2/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Nada-20Terpendam.mp3?rlkey=unmjdgs3espvoq2dtyswimxmy&st=tjm8j8k1&raw=1", gdId: "1nlR4fIW9OL3KTPSU9cCLW9rESA3A1sCb" },
        { name: "Langit Patah Arah", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/60npnlmfphhtcirdyhqyq/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Langit-20Patah-20Arah.mp3?rlkey=aevobshzsuuecl9vu3ozt655o&st=rt21gjkt&raw=1", gdId: "17R1mc6FwqbK25ynWDw9CIIM7YrbAMqJ0" },
        { name: "Tak Bernama, Tapi Ada", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/y7ei6d66334mzpjwvxxr7/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Tak-20Bernama-2C-20Tapi-20Ada.mp3?rlkey=joauzm5e5vh4lbca1ccgpjwvt&st=1kd6ap8l&raw=1", gdId: "1OkeF_VH1NJWJS-99N4kt9K5Wg1yxN37G" },
        { name: "Resonansi Dalam Diam", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/ovgaej9nunwwuwykszjs2/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Resonansi-20Dalam-20Diam.mp3?rlkey=ahn32s08fhvnfmiic5fu3jdvw&st=s46e5vva&raw=1", gdId: "1KFkKvwmFw8Fzo6ErCa65v_--BahudXM6" },
        { name: "Runtuh Tanpa Suara", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/34m3ymxxned40jfkegkkq/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Runtuh-20Tanpa-20Suara.mp3?rlkey=65hjocwfjfr7bxo8mxofrcxqz&st=vdbtdvv0&raw=1", gdId: "1v3vSjYL98fXKKgMpn_nhV-IDjsQvv_FU" },
        { name: "Kilau Tanpa Sorotan", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/ok2arwnaph6mt5rfmfb10/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Kilau-20Tanpa-20Sorotan.mp3?rlkey=6dsjfah665xk9m96tg83ynh6h&st=tr477auo&raw=1", gdId: "1PAdvzfPDXl7IeOloMDM5gngeTV0KGcIV" },
        { name: "Gelombang Terakhir", group: "Resonansi Dalam Diam", url: "https://www.dropbox.com/scl/fi/jy8rav5ef4f2co9jy0hmi/primary-3ADownload-2Fmuhaajir-2Fmusic-2FMuhaajir-20-20Gelombang-20Terakhir.mp3?rlkey=bfl4zqkolb0p8vm7kt0cbbtfn&st=txi8i6zt&raw=1", gdId: "1094sBXRKLQ2c_3fdYJjRuykxKPP0lOfx" }
      ];

            // --- LIRIK (lengkap) ---
            const lyricsMap = {
                "Lintasan Tak Bermakna": `Di garis start nyali pun bicara,\nMesin menderu bak suara raja.\nAsap naik, waktu pun lenyap,\nTiap tikungan, mimpi pun tajam.\n\nTak ada ragu dalam kecepatan,\nLintasan adalah medan keberanian.\nBan berteriak dalam keyakinan,\nMenuju juara, penuh pengorbanan.\n\nDetik berdetak di balik helm,\nFokus tajam, pikiran diam.\nSatu peluang di ujung tikungan,\nSekali salah, habis harapan.\n\nDi balik visor, mimpi menyala,\nDibakar semangat, dinginkan raga.\nGas ditekan, batas dilawan,\nDi jalur ini, hanya pemenang bertahan.\n\nSemua sepi saat melaju,\nHanya angin yang tahu arahmu.\nKeringat jatuh, hati membara,\nIni bukan sekadar lomba.\n\nTaklukan keraguan di tikungan tajam,\nJiwa pembalap tak pernah padam.\nTerjatuh? Bangkit! Jangan bertanya,\nKarena lintasan tak beri jeda.\n\nDi atas aspal, cerita ditulis,\nDengan kecepatan yang tak bisa ditangkap garis.\ngaspol taklukkan lintasan jadilah juara`,
                "Padahal Sudah Bilang": `Hari itu aku tak di kelas\nTapi pesanku sudah sampai jelas\nKuketik pelan, kuhormat seperti biasa\nKirim ke wali kupikir itu cukup\n\nTapi paginya, kulihat lembar absen\nNamaku hilang, tak ada keterangan\n\nPadahal sudah bilang\nKusampaikan baik pada yang berwenang\nTak perlu teriak, tak kurang sopan\nTapi tetap saja dianggap hilang\nPadahal aku cuma ingin dimengerti\n\nKatanya semua punya hak bicara\nTapi mengapa yang pelan tak didengar juga?\nKubiarkan kepala menunduk diam\nKarena kata-kataku dianggap tak sampai malam\n\nMungkin pesan itu terlewat\nAtau mungkin‚Ä¶ sengaja tak dilihat\n\nPadahal sudah bilang\nKujalankan aturan seperti yang diajar\nTapi tetap ditulis tanpa kabar\nSeolah tak pernah ada niat benar\nPadahal aku hanya ingin dihargai\n\nSuara pelan bukan berarti salah\nDiam bukan berarti tak usaha\nKalau pun salahku tak cukup keras\nMengapa kebenaran tak diberi tempat?\n\nPadahal sudah bilang\nKepada yang seharusnya mencatat\nTapi tetap tertulis aku tak hadir\nSeolah aku menghilang tanpa jejak\nPadahal aku‚Ä¶ selalu mencoba jujur\n\nBesok-besok, mungkin aku benar-benar diam\nBiar mereka tulis saja, Tanpa Keterangan`,
                "Mimpi yang Tertunda": `Duduk diam di sudut kamar,\nBuku terbuka tapi pikiran liar.\nCita-cita tinggi melangit,\nTapi tangan malas untuk bangkit.\n\nOrang bilang aku pemimpi,\nTerlalu banyak tidur di siang hari.\nTapi dalam hati ku tahu pasti,\nAda jalan untuk jadi berarti.\n\nTak cepat, tak langsung terbang tinggi,\nJalan lambat pun bisa berarti.\nWaktu berjalan, aku mulai sadar,\nImpian itu harus dikejar.\n\nKini aku berdiri di puncak dunia,\nDulu dihina, kini dipercaya.\nLangkahku lambat tapi tak pernah mundur,\nMimpi yang tertunda kini pun jujur.\n\nHari-hari penuh alasan,\nTapi malam penuh harapan.\nLayar penuh rencana palsu,\nTapi hati tetap tak mau jemu.\n\nAku tahu aku harus berubah,\nWalau malas sering buat resah.\nSedikit demi sedikit ku coba,\nHingga langkah kecil jadi nyata.\n\nTak cepat, tak langsung terbang tinggi,\nJalan lambat pun bisa berarti.\nWaktu berjalan, aku mulai sadar,\nImpian itu harus dikejar.\n\nKini aku berdiri di puncak dunia,\nDulu dihina, kini dipercaya.\nLangkahku lambat tapi tak pernah mundur,\nMimpi yang tertunda kini pun jujur.\n\nBukan soal seberapa cepat,\nTapi seberapa kuat niat.\nMasa lalu bukan penentu,\nKarena masa depan milik yang mau.\n\nKini aku berdiri di puncak dunia,\nBukan karena cepat, tapi karena percaya.\nLangkahku lambat tapi tak pernah luntur,\nMimpi yang tertunda‚Ä¶ akhirnya jujur.`,
                "Langit Masih Sama": `Pagi datang tanpa warna\nLangkahku berat, hati terluka\nTapi aku tahu, waktu takkan tunggu\nHarus bangkit, walau masih ragu\n\nSetiap luka ada akhirnya\nSetiap gelap pasti ada cahaya\n\nLangit masih sama, biru di atas sana\nMeski badai sempat butakan mata\nAku percaya, masih ada cahaya\nDi balik semua air mata\n\nJejak mimpi yang sempat hilang\nKupungut satu-satu dengan tenang\nTak semua indah, tapi semua nyata\nHidup bukan tentang menyerah\n\nKarena hati tak dicipta untuk padam\nWalau ribuan kali jatuh tenggelam\n\nLangit masih sama, biru di atas sana\nMeski badai sempat butakan mata\nAku percaya, masih ada cahaya\nDi balik semua air mata\n\nSaat kau pikir semua terlambat\nIngat, mentari tak pernah ingkar tempat\nHari ini mungkin tak sempurna\nTapi esok bisa jadi cerita\n\nLangit masih sama, biru di atas sana\nDan kini ku tahu, ku tak sendiri\nAku percaya, masih ada cahaya\nYang menuntunku kembali`,
                "Suatu Hari Nanti": `Di sudut kecil kota yang tenang\nAku duduk bermimpi tentang lintasan panjang\nTak ada sorak, tak ada gemerlap\nHanya tekad di dada yang tak pernah lenyap\n\nTak semua orang bisa mengerti\nLangkah kecil yang kuambil setiap hari\nTapi aku tahu, dalam hati\nSetiap peluh ini punya arti\n\nSuatu hari nanti, aku melaju\nMelewati badai, luka, dan ragu\nSuatu hari nanti, ku buktikan\nBahwa mimpi tak pernah jadi angan-angan\n\nKadang dunia terasa berat\nLangkah tertahan, harapan nyaris tersesat\nTapi aku belajar dari kesakitan\nBahwa jatuh bukan akhir perjalanan\n\nDari malam-malam panjang yang sunyi\nDari tangis yang tak pernah terlihat di sini\nKupahat impian di dinding hati\nDan ku bawa sampai akhir nanti\n\nSuatu hari nanti, aku melaju\nBukan hanya cepat, tapi penuh makna\nSuatu hari nanti, dunia tahu\nAda harga dari tiap jejak yang kutuju\n\nAku bermimpi...\nMenjadi juara dunia\nBukan sekadar piala\nTapi juara dari segala luka dan usaha\n\nSuatu hari nanti, ku tak sendiri\nOrang-orang yang kusayang ikut berdiri\nSuatu hari nanti, semua ini\nJadi cerita tentang gigih yang tak pernah mati`,
                "Nada Terpendam": `Di balik senyum, tersimpan\nSebuah lagu yang tak pernah dinyanyikan\nNada-nada yang kusimpan\nDalam sunyi yang terus menjerat\n\nKata ingin keluar, tapi takut terdengar\nTakut dihancurkan oleh waktu yang salah\nJadi kupendam dalam ruang\nYang hanya aku dan sepi yang tahu\n\nKupeluk luka dalam diam\nMenunggu hari yang paham\n\nAndai kau tahu lagu di hatiku\nYang tak pernah punya panggung untuk tumbuh\nDi setiap helaan napas yang tertahan\nNada terpendam, nyanyian yang tertelan\n\nKadang ingin aku teriak\nTapi dunia sibuk dengan suaranya\nTak ada ruang tuk bisikanku\nYang perlahan hilang jadi abu\n\nKupeluk mimpi yang tak terang\nMasih berharap kau datang\n\nAndai kau tahu lagu di hatiku\nYang tak pernah punya panggung untuk tumbuh\nDi setiap helaan napas yang tertahan\nNada terpendam, nyanyian yang tertelan\n\nMungkin suatu hari nanti\nAda telinga yang mau mengerti\nTapi sampai saat itu tiba\nBiar kusimpan lagu ini sendiri\n\nAndai kau tahu, betapa ku ingin\nMenyanyikan semua yang terkunci\nNamun bibirku masih terkunci oleh sunyi\nNada terpendam, tetap menanti‚Ä¶\n\nDi balik senyum, tersimpan\nLagu yang tak pernah dinyanyikan...`,
                "Langit Patah Arah": `Langit pun salah menatap\nSeperti aku, tak tahu harus ke mana\nSenja tak lagi jingga\nWaktu pun enggan bicara\n\nLangkahku kabur di bayang\nArah hilang, peta pun tenggelam\nKupanggil namaku sendiri\nTak ada gema, hanya sepi\n\nLangit patah arah\nTak tahu barat dari timur\nSeperti hati yang retak\nDalam kabut rindu yang hancur\n\nLangit patah arah\nTak bisa bedakan pagi atau petang\nSeperti aku yang hilang\nTak temukan pulang\n\nMungkin waktu perlu diam\nUntuk dengar suara dalam\nMungkin aku perlu hilang\nAgar tahu di mana terang\n\nLangit patah arah\nTak tahu barat dari timur\nSeperti hati yang retak\nDalam kabut rindu yang hancur\n\nLangit patah arah\nTak bisa bedakan pagi atau petang\nSeperti aku yang hilang\nTak temukan pulang\n\nLangit pun salah menatap\nDan aku masih... tak tahu harus ke mana`,
                "Tak Bernama, Tapi Ada": `Aku tak dikenal oleh dunia\nTak tercatat dalam sejarah siapa-siapa\nTapi aku pernah menolong tanpa disadari\nLangkahku sunyi, tapi tetap berarti\n\nKau tak pernah lihat aku\nTapi aku selalu ada di balik bayangmu\n\nTak bernama, tapi aku ada\nDalam tawa yang kau rasa\nTak tertulis, tapi nyata\nDi tiap detak yang buatmu percaya\n\nAku bayang dalam keramaian\nSenyum yang singgah tanpa kau tahu siapa\nMungkin kau lupa, atau tak pernah sadar\nAda aku di balik hari yang lebih sabar\n\nAku bukan siapa-siapa\nTapi aku pernah jadi alasmu berdiri\n\nTak bernama, tapi aku ada\nDalam hangat yang kau kira fana\nTak terlihat, tapi terasa\nSeperti suara saat kau diam\n\nBukan pujian yang kucari\nCukup kau berjalan lagi‚Ä¶\n\nTak bernama, tapi aku ada\nDalam luka yang perlahan reda\nTak tertulis, tapi nyata\nSeperti angin yang buatmu bertahan\n\nMungkin aku akan dilupa...\nTapi jejakku... tetap ada...\nTak bernama... tapi aku ada‚Ä¶`,
                "Resonansi Dalam Diam": `Dalam sunyi aku berbicara\nTanpa kata, tanpa suara\nSetiap jeda penuh makna\nYang tak sempat terucap nyata\n\nMereka bilang aku diam\nPadahal hatiku bergemuruh\nBukan bisu, hanya tenggelam\nDalam dunia yang terlalu gaduh\n\nDiamku bukan hampa\nTapi gema yang tak kau dengar\nDetak jantung, hembus napas\nNada yang tak pernah lepas\n\nDiamku bukan akhir\nTapi awal yang lebih dalam\nResonansi dalam diam\nMenembus ruang dan waktu diam-diam\n\nBayang-bayang menari perlahan\nDi ruang kosong penuh kenangan\nKutatap langit tanpa warna\nMencari arti dalam gelap yang bicara\n\nTak perlu teriak tuk mengguncang\nKadang senyap lebih menyentuh\nTanpa ada ini\nKau takkan tahu artinya peluk tanpa peluh\n\nDiamku bukan hampa\nTapi gema yang tak kau dengar\nDetak jantung, hembus napas\nNada yang tak pernah lepas\n\nDiamku bukan akhir\nTapi awal yang lebih dalam\nResonansi dalam diam\nMenembus ruang dan waktu diam-diam\n\nCobalah dengar\nBila hatimu masih peka\nDiam ini bicara\nDengan cara yang tak biasa`,
                "Runtuh Tanpa Suara": `Langit kelabu di dalam dadaku\nLangkahku berat, tapi kau tak tahu\nAku tersenyum di depanmu\nPadahal hatiku nyaris membeku\n\nKau berjalan tanpa menoleh\nAku tenggelam dalam bayangmu\nDan dunia tetap berputar\nMeski aku tak lagi utuh\n\nBahkan tangisku terlalu lirih\nUntuk mengguncang perhatianmu\nAku runtuh tanpa suara\nDi titik terendah, kau tak melihatku\nCinta ini jadi rahasia\nYang hanya aku dan malam tahu\n\nKau tertawa, aku ikut tertawa\nPadahal jiwaku sedang patah\nKau bahagia, aku pura-pura\nMenjadi kuat, meski tak kuasa\n\nAndai kau tahu, betapa aku\nMenunggu satu tatapan darimu\nTapi aku hanyalah bayangan\nYang kau lewati tanpa perasaan\n\nBahkan tangisku terlalu lirih\nUntuk mengguncang perhatianmu\nAku runtuh tanpa suara\nDi titik terendah, kau tak melihatku\nCinta ini jadi rahasia\nYang hanya aku dan malam tahu\nDan mungkin, selamanya begitu...\nAku runtuh...\nTanpa suara...`,
                "Kilau Tanpa Sorotan": `Langkah kecil di jalan sepi\nTak ada sorot, tak ada tepuk tangan\nNamun hatiku tetap bernyanyi\nKilauku tak butuh panggung besar\n\nKilau tanpa sorotan\nTetap hidup dalam diam\nResonansi yang perlahan\nMengalun di ruang tenang\n\nBayangan jatuh, cahaya redup\nAku masih berdiri, tak perlu bukti\nDalam senyap aku menemukan\nArti hadir tanpa keramaian\n\nKilau tanpa sorotan\nTetap hidup dalam diam\nResonansi yang perlahan\nMengalun di ruang tenang\n\nTak semua harus terlihat\nTak semua harus terdengar\nAda indah yang sederhana\nAda damai tanpa suara\n\nKilauku‚Ä¶ tetap ada\nMeski tanpa sorotan\nResonansi‚Ä¶ dalam diam\nMengikat jiwa perlahan`,
                "Gelombang Terakhir": `Di tepi senja aku menunggu\nGelombang terakhir datang membisu\nAngin berbisik, waktu pun layu\nNada sederhana, hati pun luluh\n\nGelombang terakhir, bawa aku pergi\nTemani langkah, temani mimpi\nKita hanyut, tanpa janji lagi\nGelombang terakhir, aku percaya diri\n\nLangkah kecil di pasir yang hilang\nJejakmu samar, tapi tetap tenang\nCahaya redup, tak perlu terang\nRitme sederhana, rasa pun datang\n\nGelombang terakhir, bawa aku pergi\nTemani langkah, temani mimpi\nKita hanyut, tanpa janji lagi\nGelombang terakhir, aku percaya diri\n\nTak ada kata, hanya rasa\nMengalir pelan, seperti nada\nGelombang terakhir, aku percaya\nDiam pun bisa jadi suara\n\nGelombang terakhir‚Ä¶\nGelombang terakhir‚Ä¶\nTemani aku sampai tenang‚Ä¶`
            };
      const defaultLyrics = "üéµ Lirik menyusul. Nikmati instrumen.";

      // Elemen DOM
      const audio = document.getElementById('audio-engine');
      const playBtn = document.getElementById('play-trigger');
      const playIcon = document.getElementById('play-icon');
      const playbackStatus = document.getElementById('playback-status');
      const lyricsDiv = document.getElementById('lyrics-display');
      const progFill = document.getElementById('progress-fill');
      const timeNow = document.getElementById('time-now');
      const timeEnd = document.getElementById('time-end');
      const displayTitle = document.getElementById('display-title');
      const displayAlbum = document.getElementById('display-album');
      const rotatingName = document.getElementById('rotating-name');
      const shareIconBtn = document.getElementById('share-icon-btn');
      const shuffleBtn = document.getElementById('shuffle-btn');
      const repeatBtn = document.getElementById('repeat-btn');
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const volSlider = document.getElementById('vol-slider');
      const progRoot = document.getElementById('prog-root');

      // State
      let currentIndex = 0;
      let isShuffle = false;
      let isRepeat = false;
      let lyricsUpdateTimer = null; // tidak dipakai, tapi untuk jaga-jaga
      let isUserInteracted = false;

      audio.volume = 0.7;

      function updateAccentByGroup(group) {
        const goldDefault = '#ffd700';
        const blueAccent = '#00d4ff';
        root.style.setProperty('--gold-primary', group === 'Fragmen Suara' ? blueAccent : goldDefault);
      }

      function formatTime(seconds) {
        if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
        const m = Math.floor(seconds / 60);
        const s = Math.floor(seconds % 60);
        return `${m}:${s.toString().padStart(2, '0')}`;
      }

      function loadSong(index, skipPlay = false) {
        const song = rawSongs[index];
        if (!song) return;

        updateAccentByGroup(song.group);
        displayTitle.textContent = song.name;
        displayAlbum.textContent = song.group;
        updateLyrics();

        audio.removeEventListener('error', handleAudioError);

        audio.src = song.url;
        audio.load();

        let fallbackTried = false;

        function handleAudioError(e) {
          if (fallbackTried) {
            playbackStatus.textContent = '‚ùå Gagal memuat lagu';
            playbackStatus.classList.add('error-message');
            return;
          }
          fallbackTried = true;
          console.warn('Dropbox error, mencoba Google Drive...');
          if (song.gdId) {
            audio.src = `https://drive.google.com/uc?export=download&id=${song.gdId}`;
            audio.load();
            if (!skipPlay && isUserInteracted) {
              audio.play().catch(err => {
                playbackStatus.textContent = '‚ùå Gagal memuat lagu';
                playbackStatus.classList.add('error-message');
              });
            }
          } else {
            playbackStatus.textContent = '‚ùå Gagal memuat lagu';
            playbackStatus.classList.add('error-message');
          }
        }

        audio.addEventListener('error', handleAudioError);

        if (!skipPlay && isUserInteracted) {
          audio.play().catch(e => handleAudioError(e));
        }

        document.querySelectorAll('.track-item').forEach(el => el.classList.remove('active'));
        const activeItem = document.querySelector(`.track-item[data-index="${index}"]`);
        if (activeItem) activeItem.classList.add('active');

        if ('mediaSession' in navigator) {
          navigator.mediaSession.metadata = new MediaMetadata({
            title: song.name,
            artist: 'Muhaajir',
            album: song.group,
            artwork: [{ src: 'https://i.postimg.cc/Kvg50f5n/IMG-20250812-164118-putih.png', sizes: '512x512', type: 'image/png' }]
          });
        }
      }

      // Fungsi updateLyrics: tampilan rapat dengan jarak antar paragraf
      function updateLyrics() {
        if (!lyricsDiv) return;
        lyricsDiv.style.opacity = '0';
        setTimeout(() => {
          const song = rawSongs[currentIndex];
          const text = lyricsMap[song?.name] || `üéµ ${song?.name}\n\n${defaultLyrics}`;
          
          // Pisahkan berdasarkan baris baru
          const lines = text.split('\n');
          let html = '';
          
          lines.forEach(line => {
            if (line.trim() === '') {
              // Baris kosong: beri jarak antar paragraf
              html += '<div class="lyric-paragraph-space"></div>';
            } else {
              html += `<span class="lyric-line">${line}</span>`;
            }
          });
          
          lyricsDiv.innerHTML = html;
          lyricsDiv.scrollTop = 0; // Reset scroll ke atas setiap ganti lagu
          lyricsDiv.style.opacity = '1';
        }, 150);
      }

      // Fungsi auto-scroll dihapus / tidak dipakai

      function renderPlaylist() {
        const container = document.getElementById('playlist-inject');
        if (!container) return;
        container.innerHTML = '';
        let lastGroup = '';
        rawSongs.forEach((s, i) => {
          if (s.group !== lastGroup) {
            lastGroup = s.group;
            const lbl = document.createElement('div');
            lbl.className = 'group-label';
            lbl.innerText = s.group;
            container.appendChild(lbl);
          }
          const item = document.createElement('div');
          item.className = 'track-item';
          item.setAttribute('data-index', i);
          item.innerHTML = `<span class="t-num">${i+1}</span><span class="t-name">${s.name}</span>`;
          item.addEventListener('click', () => {
            isUserInteracted = true;
            currentIndex = i;
            loadSong(currentIndex, false);
          });
          container.appendChild(item);
        });
        const active = document.querySelector(`.track-item[data-index="${currentIndex}"]`);
        if (active) active.classList.add('active');
      }

      // Event listeners
      playBtn.addEventListener('click', () => {
        isUserInteracted = true;
        if (audio.paused) {
          audio.play();
          playIcon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
          playbackStatus.textContent = '‚ñ∂Ô∏è Memutar...';
        } else {
          audio.pause();
          playIcon.innerHTML = '<path d="M8 5v14l11-7z"/>';
          playbackStatus.textContent = '‚è∏Ô∏è Menjeda';
        }
      });

      audio.addEventListener('play', () => {
        playIcon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>';
        playbackStatus.textContent = '‚ñ∂Ô∏è Memutar...';
        // HAPUS PANGGILAN auto-scroll
        // startLyricsAutoScroll();
      });

      audio.addEventListener('pause', () => {
        playIcon.innerHTML = '<path d="M8 5v14l11-7z"/>';
        playbackStatus.textContent = '‚è∏Ô∏è Menjeda';
        if (lyricsUpdateTimer) clearInterval(lyricsUpdateTimer); // tetap bersihkan jika ada
      });

      audio.addEventListener('ended', () => {
        if (isRepeat) {
          audio.currentTime = 0;
          audio.play();
        } else {
          nextBtn.click();
        }
      });

      audio.addEventListener('timeupdate', () => {
        if (audio.duration) {
          const percent = (audio.currentTime / audio.duration) * 100;
          progFill.style.width = percent + '%';
          timeNow.textContent = formatTime(audio.currentTime);
          timeEnd.textContent = formatTime(audio.duration);
        }
      });

      progRoot.addEventListener('click', (e) => {
        isUserInteracted = true;
        const rect = progRoot.getBoundingClientRect();
        const clickX = e.clientX - rect.left;
        const width = rect.width;
        const seekTime = (clickX / width) * audio.duration;
        audio.currentTime = seekTime;
      });

      volSlider.addEventListener('input', (e) => {
        audio.volume = e.target.value;
      });

      prevBtn.addEventListener('click', () => {
        isUserInteracted = true;
        if (isShuffle) {
          let rand;
          do { rand = Math.floor(Math.random() * rawSongs.length); } while (rand === currentIndex && rawSongs.length > 1);
          currentIndex = rand;
        } else {
          currentIndex = (currentIndex - 1 + rawSongs.length) % rawSongs.length;
        }
        loadSong(currentIndex, false);
      });

      nextBtn.addEventListener('click', () => {
        isUserInteracted = true;
        if (isShuffle) {
          let rand;
          do { rand = Math.floor(Math.random() * rawSongs.length); } while (rand === currentIndex && rawSongs.length > 1);
          currentIndex = rand;
        } else {
          currentIndex = (currentIndex + 1) % rawSongs.length;
        }
        loadSong(currentIndex, false);
      });

      shuffleBtn.addEventListener('click', () => {
        isShuffle = !isShuffle;
        shuffleBtn.classList.toggle('active', isShuffle);
      });

      repeatBtn.addEventListener('click', () => {
        isRepeat = !isRepeat;
        repeatBtn.classList.toggle('active', isRepeat);
      });

      shareIconBtn.addEventListener('click', () => {
        const song = rawSongs[currentIndex];
        if (song) shareToWhatsApp(song.name);
      });

      const names = ["Muhaajir", "Suni", "Brava", "Niva", "Ricerca", "Genio", "Chopi", "Chita", "Hajir", "Regina"];
      let nameIdx = 0;
      setInterval(() => {
        nameIdx = (nameIdx + 1) % names.length;
        rotatingName.textContent = names[nameIdx];
      }, 1300);

      // Init
      window.addEventListener('load', () => {
        renderPlaylist();
        const firstSong = rawSongs[0];
        displayTitle.textContent = firstSong.name;
        displayAlbum.textContent = firstSong.group;
        updateAccentByGroup(firstSong.group);
        updateLyrics();
        audio.src = firstSong.url;
        audio.load();

        setTimeout(() => {
          const login = document.getElementById('loginScreen');
          login.classList.add('hidden');
          setTimeout(() => login.remove(), 600);
        }, 1500);
      });

      window.addEventListener('beforeunload', () => {
        if (lyricsUpdateTimer) clearInterval(lyricsUpdateTimer);
      });
    })();
  </script>
</body>
</html>